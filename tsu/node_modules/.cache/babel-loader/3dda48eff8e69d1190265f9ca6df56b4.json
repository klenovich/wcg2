{"ast":null,"code":"import _slicedToArray from\"/Users/lucasklenovich/Documents/GitHub/wcg2/tsu/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useRef,useEffect,useContext}from\"react\";import{AppContext}from\"../App\";import{useClickOutside}from\"../utils/useClickOutside\";import Modal from\"./modal.component\";import{VscGraphLine}from\"react-icons/vsc\";import{useCookies}from\"react-cookie\";import{FINISHED_WIN,FINISHED_LOSE,IN_PROCESS}from\"../constants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Report=function Report(){var _statistics$guessDist;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState({currentStreak:0,maxStreak:0,totalPlayed:0,totalWin:0,winPerc:0,guessDistribution:[],history:[]}),_useState4=_slicedToArray(_useState3,2),statistics=_useState4[0],setStatistics=_useState4[1];var ref=useRef(null);useClickOutside(ref,function(){return setOpen(false);});var _useContext=useContext(AppContext),game=_useContext.game,random=_useContext.random,numGuesses=_useContext.numGuesses;var handleMarkClick=function handleMarkClick(event){event.preventDefault();setOpen(function(){return!open;});};var _useCookies=useCookies(),_useCookies2=_slicedToArray(_useCookies,2),cookies=_useCookies2[0],setCookie=_useCookies2[1];useEffect(function(){var cockieFound=cookies&&cookies.statistics;var currentStreak=cockieFound?cookies.statistics.currentStreak:0;var maxStreak=cockieFound?cookies.statistics.maxStreak:0;var totalPlayed=cockieFound?cookies.statistics.totalPlayed:0;var totalWin=cockieFound?cookies.statistics.totalWin:0;var winPerc=cockieFound?totalWin/totalPlayed:0;var guessDistribution=cockieFound?cookies.statistics.guessDistribution:[0,0,0,0,0,0];var history=cockieFound?cookies.statistics.history:[];setStatistics({currentStreak:currentStreak,maxStreak:maxStreak,totalPlayed:totalPlayed,totalWin:totalWin,winPerc:winPerc,guessDistribution:guessDistribution,history:history});if(game!==IN_PROCESS&&!history.includes(random)){totalPlayed+=1;if(game===FINISHED_LOSE){currentStreak=0;}else if(game===FINISHED_WIN){currentStreak+=1;totalWin+=1;guessDistribution[numGuesses-1]+=1;if(currentStreak>maxStreak){maxStreak=currentStreak;}}winPerc=totalWin/totalPlayed;history.push(random);var newStatistics={currentStreak:currentStreak,maxStreak:maxStreak,totalPlayed:totalPlayed,totalWin:totalWin,winPerc:winPerc,guessDistribution:guessDistribution,history:history};setCookie(\"statistics\",JSON.stringify(newStatistics),{maxAge:315360000});}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[game,cookies]);return/*#__PURE__*/_jsxs(\"div\",{ref:ref,children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex content-center items-center hover:bg-opacity-50 duration-200 text-slate-300 hover:text-white font-light\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleMarkClick,children:/*#__PURE__*/_jsx(VscGraphLine,{})})}),/*#__PURE__*/_jsxs(Modal,{setOpen:setOpen,open:open,id:\"modal-report\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"w-full border-b text-center text-lg md:text-2xl\",children:\"Statistics\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full grid grid-cols-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:statistics.currentStreak}),\"Current Streak\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:statistics.maxStreak}),\"Max Streak\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col text-center\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[Math.floor(statistics.winPerc*100),\"%\"]}),\"Win Percent\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:statistics.totalPlayed}),\"Total Played\"]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:\"Distribution\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-between\",children:(_statistics$guessDist=statistics.guessDistribution)===null||_statistics$guessDist===void 0?void 0:_statistics$guessDist.map(function(e,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:e}),/*#__PURE__*/_jsxs(\"div\",{children:[i+1,/*#__PURE__*/_jsx(\"sup\",{children:i===0?\"st\":i===1?\"nd\":i===2?\"rd\":\"th\"})]})]},i);})})]})]})]});};export default Report;","map":{"version":3,"names":["useState","useRef","useEffect","useContext","AppContext","useClickOutside","Modal","VscGraphLine","useCookies","FINISHED_WIN","FINISHED_LOSE","IN_PROCESS","Report","open","setOpen","currentStreak","maxStreak","totalPlayed","totalWin","winPerc","guessDistribution","history","statistics","setStatistics","ref","game","random","numGuesses","handleMarkClick","event","preventDefault","cookies","setCookie","cockieFound","includes","push","newStatistics","JSON","stringify","maxAge","Math","floor","map","e","i"],"sources":["/Users/lucasklenovich/Documents/GitHub/wcg2/tsu/src/components/report.component.tsx"],"sourcesContent":["import { useState, useRef, useEffect, useContext } from \"react\";\nimport { AppContext } from \"../App\";\nimport { useClickOutside } from \"../utils/useClickOutside\";\nimport Modal from \"./modal.component\";\nimport { VscGraphLine } from \"react-icons/vsc\";\nimport { useCookies } from \"react-cookie\";\nimport { FINISHED_WIN, FINISHED_LOSE, IN_PROCESS } from \"../constants\";\n\nconst Report = () => {\n  const [open, setOpen] = useState<boolean>(false);\n  const [statistics, setStatistics] = useState<{\n    currentStreak: number;\n    maxStreak: number;\n    totalPlayed: number;\n    totalWin: number;\n    winPerc: number;\n    guessDistribution: number[];\n    history: number[];\n  }>({\n    currentStreak: 0,\n    maxStreak: 0,\n    totalPlayed: 0,\n    totalWin: 0,\n    winPerc: 0,\n    guessDistribution: [],\n    history: [],\n  });\n  const ref = useRef<HTMLDivElement>(null);\n  useClickOutside(ref, () => setOpen(false));\n  const { game, random, numGuesses } = useContext(AppContext);\n\n  const handleMarkClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    setOpen(() => !open);\n  };\n  const [cookies, setCookie] = useCookies();\n\n  useEffect(() => {\n    const cockieFound = cookies && cookies.statistics;\n    var currentStreak = cockieFound ? cookies.statistics.currentStreak : 0;\n    var maxStreak = cockieFound ? cookies.statistics.maxStreak : 0;\n    var totalPlayed = cockieFound ? cookies.statistics.totalPlayed : 0;\n    var totalWin = cockieFound ? cookies.statistics.totalWin : 0;\n    var winPerc = cockieFound ? totalWin / totalPlayed : 0;\n    var guessDistribution = cockieFound\n      ? cookies.statistics.guessDistribution\n      : [0, 0, 0, 0, 0, 0];\n    var history = cockieFound ? cookies.statistics.history : [];\n    setStatistics({\n      currentStreak,\n      maxStreak,\n      totalPlayed,\n      totalWin,\n      winPerc,\n      guessDistribution,\n      history,\n    });\n\n    if (game !== IN_PROCESS && !history.includes(random)) {\n      totalPlayed += 1;\n      if (game === FINISHED_LOSE) {\n        currentStreak = 0;\n      } else if (game === FINISHED_WIN) {\n        currentStreak += 1;\n        totalWin += 1;\n        guessDistribution[numGuesses - 1] += 1;\n        if (currentStreak > maxStreak) {\n          maxStreak = currentStreak;\n        }\n      }\n      winPerc = totalWin / totalPlayed;\n      history.push(random);\n      const newStatistics = {\n        currentStreak,\n        maxStreak,\n        totalPlayed,\n        totalWin,\n        winPerc,\n        guessDistribution,\n        history,\n      };\n      setCookie(\"statistics\", JSON.stringify(newStatistics), {\n        maxAge: 315360000,\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [game, cookies]);\n\n  return (\n    <div ref={ref}>\n      <div className=\"flex content-center items-center hover:bg-opacity-50 duration-200 text-slate-300 hover:text-white font-light\">\n        <button onClick={handleMarkClick}>\n          <VscGraphLine />\n        </button>\n      </div>\n      <Modal setOpen={setOpen} open={open} id=\"modal-report\">\n        <p className=\"w-full border-b text-center text-lg md:text-2xl\">\n          Statistics\n        </p>\n        <br />\n        <div className=\"w-full grid grid-cols-4\">\n          <div className=\"flex flex-col text-center\">\n            <span className=\"font-medium\">{statistics.currentStreak}</span>\n            Current Streak\n          </div>\n          <div className=\"flex flex-col text-center\">\n            <span className=\"font-medium\">{statistics.maxStreak}</span>\n            Max Streak\n          </div>\n          <div className=\"flex flex-col text-center\">\n            <span className=\"font-medium\">\n              {Math.floor(statistics.winPerc * 100)}%\n            </span>\n            Win Percent\n          </div>\n          <div className=\"flex flex-col text-center\">\n            <span className=\"font-medium\">{statistics.totalPlayed}</span>\n            Total Played\n          </div>\n        </div>\n        <br />\n        <div className=\"\">\n          <div className=\"flex justify-center\">Distribution</div>\n          <div className=\"flex justify-between\">\n            {statistics.guessDistribution?.map((e: number, i: number) => {\n              return (\n                <div className=\"flex flex-col\" key={i}>\n                  <div className=\"font-medium\">{e}</div>\n                  <div>\n                    {i + 1}\n                    <sup>\n                      {i === 0 ? \"st\" : i === 1 ? \"nd\" : i === 2 ? \"rd\" : \"th\"}\n                    </sup>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n};\n\nexport default Report;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}